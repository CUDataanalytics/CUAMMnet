---
title: "DATA VISUALIZATION"
author: "D.K.MURIITHI"
date: "2024-07-24"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
	echo = TRUE,
	fig.height = 4,
	fig.width = 6,
	message = FALSE,
	warning = FALSE,
	comment = NA)
```

## confirmation and setting of working directory

```{r}
setwd("C:\\Users\\Prof DK\\Desktop\\TMMS2024")
```


## Installation and loading of necessary packages/libraries

# Installing packages

# Loading libraries
```{r}
library(tidyverse) ##for data manipulation
library(psych) ##for description of  data
```

# Load Example data 
```{r}
malaria_data <- read.csv("mockdata_cases.csv")
#mosquito_data <- read.csv("C:/Users/Prof DK/Desktop/TMMS2024/mosq_mock.csv")
```

# Characterizing our data
Before we start visualizing our data, we need to understand the characteristics of our data. The goal is to get an idea of the data structure and to understand the relationships between variables.

# Explore the structure and summary of the datasets
```{r}
dim(malaria_data)
```

```{r}
head(malaria_data,5)
```

```{r}
summary(malaria_data)
```

```{r}
describe(malaria_data)
```


#We should also explore individual columns/variables

```{r}
malaria_data$location          # values for a single column
#malaria_data$month
#malaria_data$year
```


```{r}
unique(malaria_data$location)  # unique values for a single column
```

```{r}
table(malaria_data$location)   # frequencies for a single column
```

```{r}
table(malaria_data$location, malaria_data$ages)  # frequencies for multiple columns
```

# check for missing values in each column, as these can affect our visualizations.
```{r}
sum(is.na(malaria_data))
```
# ---------------------------------------------------------------------------
# Challenge 1: Explore the structure and summary of the mosquito_data dataset
# ---------------------------------------------------------------------------
What are the dimensions of the dataset?
```{r}
dim(mosquito_data)
```

What are the column names?
```{r}
colnames(mosquito_data)
```

What are the column types?
```{r}
sapply(mosquito_data, class)
```

What are some key variables or relationships that we can explore?

```{r}
summarise(mosquito_data)
```
# -------------------------------------------------------
# Exploratory Visualizations Using Base R Functions
# ------------------------------------------------------
First, we will look at some exploratory data visualization techniques using base R functions. The purpose of these plots is to help us understand the relationships between variables and characteristics of our data. They are useful for quickly exploring the data and understanding the relationships, but they are not are not great for sharing in scientific publications/presentations.

# Single variable comparison

#1. Histogram
For one variable comparison, we can use hist() function to create a histogram.

```{r}
hist(malaria_data$prev)
```

```{r}
hist(malaria_data$prev, 
    breaks = 5, 
    main = "Distribution of Malaria Prevalence",
    xlab = "Malaria Prevalence",
    ylab = "Frequency",
    col = "tomato",
    border = "darkblue")
```

#2. Barplot
Another useful function for single variable comparisons is barplot(). 
In this case, we will use the table() function to count the number of observations in each category, then use barplot() to create a barplot.

```{r}
barplot(table(malaria_data$location))
barplot(table(malaria_data$year))
```

# Multiple variables
For multiple variables, we can use plot() function to create a scatterplot. In this case, we will use the S operator to pull out an individual column from the dataset. Then we will use plot() to create a scatterplot. The first argument in plot() is the x variable, and the second argument is the y variable.

# scatterplot
```{r}
plot(malaria_data$total, malaria_data$positive)
plot(malaria_data$month, malaria_data$positive)
```
# Boxplot

A boxplot, also known as a box-and-whisker plot, is a standardized way of displaying the distribution of data based on a five-number summary: minimum, first quartile (Q1), median, third quartile (Q3), and maximum.

# Importance of Boxplots
  * Provide a clear and concise visual summary of the data distribution, showing central tendency,                    variability, and symmetry or skewness.
  
  * They are excellent tools for comparing distributions across different groups or categories, allowing quick        visual comparisons.
  
  * Identifying Outliers: Boxplots help identify outliers in the data, which can be crucial for understanding data     quality and distribution.
  
  * Understanding Spread: They reveal the spread and range of the data, indicating the variability within the         dataset
```{r}
boxplot(malaria_data$prev ~ malaria_data$location) 
boxplot(malaria_data$prev ~ malaria_data$month) 
```

# ---------------------------------------------------------------------------
# Challenge 2: Explore the structure and summary of the mosquito_data dataset
# ---------------------------------------------------------------------------
Are their any interesting patterns in individual variables/columns?
Are there any relationships between variables/columns?

```{r}
barplot(table(mosquito_data$Location))
#boxplot(table(mosquito_data$Compound.ID))
```

```{r}
#View(mosquito_data)
```

# --------------------------------------------------------------------------
# Data Visualization with ggplot2
# --------------------------------------------------------------------------
Base R functions like hist() and barplot() are great for quickly exploring our data, but we may want to use more powerful visualization techniques when preparing outputs for scientific reports, presentations, and publications.

The ggplot2 package is a popular visualization package for R. It provides an easy-to-use interface for creating data visualizations. The ggplot2 package is based on the “grammar of graphics” and is a powerful way to create complex visualizations that are useful for creating scientific and publication-quality figures.

The “grammar of graphics” used in ggplot2 is a set of rules that are used to develop data visualizations using a layering approach. Layers are added using the ‘+’ operator.

# Components of a ggplot
There are three main components of a ggplot: 
1. The data: the dataset we want to visualize 
2. The aesthetics: the visual properties from the data used in the plot 
3. The geometries: the visual representations of the data (e.g., points, lines, bars)

# The data
All ggplot2 plots require a data frame as input. Just running this line will produce a blank plot because we have stated which elements from the data we want to visualize or how we want to visualize them.

```{r}
ggplot(data = malaria_data) 
```

# The aesthetics
Next, we need to specify the visual properties of the plot that are determined by the data. The aesthetics are specified using the aes() function. The output should now produce a blank plot but with determined visual properties (e.g., axes labels).

```{r}
ggplot(data = malaria_data, aes(x = total, y = positive)) 
```

# The geometries
Finally, we need to specify the visual representation of the data. The geometries are specified using the geom_* function. There are many different types of geometries that can be used in ggplot2. We will use geom_point() in this example and we will append it to the previous plot using the + operator. The output should now produce a plot with the specified visual representation of the data.

```{r}
ggplot(data = malaria_data, aes(x = total, y = positive)) + 
  geom_point()

ggplot(data = malaria_data, aes(x = total, y = positive)) + 
  geom_point(colour = "tomato") 

ggplot(data = malaria_data, aes(x = total, y = positive)) + 
  geom_point() +
  geom_smooth(method = "lm")  # The smooth geom add a smoothed line to the plot

ggplot(data = malaria_data, aes(x = total, y = positive, color = location)) + 
  geom_point() +
  theme_classic()

ggplot(data = malaria_data, aes(x = total, y = positive, color = location)) + 
  geom_point() +
  facet_wrap(~location) +
  theme_bw()

ggplot(data = malaria_data, aes(x = total, y = positive, color = location)) + 
  geom_point() +
  geom_smooth(method = "lm") +  # The smooth geom add a smoothed line to the plot
  theme_classic()
```

```{r}
ggplot(data = malaria_data, aes(x= prev))+
  geom_histogram(bins = 10)
```

#Here are some examples of different geom functions:

```{r}
ggplot(data = malaria_data, aes(x = year)) +
  geom_bar(fill = "red")   # the "fill" argument specifies the color of the bars
```

When using the aes() function, the visual properties will be determined by a variable in the dataset. This allows us to visualize relationships between multiple variables at the same time.

```{r}
ggplot(data = malaria_data, aes(x = prev, fill = ages)) +
  geom_histogram(color = "black") +
theme_classic()
```
# -------------------------------------------------------------------------
# Challenge 3: Create ggplot2 visualizations of the ‘mosquito_data’ dataset
# -------------------------------------------------------------------------
Are their any interesting patterns in individual variables/columns?
How can we use the aes() function to view multiple variables in a single plot?
Are there any additional geometries that may be useful for visualizing this dataset?


#The examples above show how to use colors for categorical variables, but we can also use custom color palettes for continuous variables.

```{r}
ggplot(data = malaria_data, aes(x = total, y = positive, color = prev)) +
  geom_point() +
  scale_color_gradient(low = "blue", high = "red")
```

```{r}
ggplot(data = malaria_data, aes(x = total, y = positive, color = prev)) +
  geom_point() +
  # use viridis package to create custom color palettes
  scale_color_viridis_c(option = "magma")  
```


```{r}
ggplot(data = malaria_data, aes(x = prev, fill = ages)) +
  geom_histogram(bins = 10) +
  scale_fill_viridis_d() +
  facet_grid(year ~ .)
```


```{r}
ggplot(data = malaria_data, aes(x = location, y = prev)) +
  geom_boxplot(fill = "lightblue") +
  geom_jitter(alpha = 0.2) +
  theme_classic()

ggplot(data = malaria_data, aes(x = location, y = prev, fill = location)) +
  geom_boxplot() +
  geom_jitter(alpha = 0.2, aes(color = location)) +
  theme_classic()
```
```{r}
ggplot(data = malaria_data, aes(x = location, y = prev)) +
  geom_violin(fill = "tomato") +
  geom_jitter(alpha = 0.2) +
  theme_classic()
```


```{r}
ggplot(data = malaria_data, aes(x = prev, fill = ages)) + 
  geom_histogram(colour = "black", bins = 12)
```

```{r}
ggplot(data = malaria_data, aes(x = location, y = prev, fill = location)) +
  geom_boxplot() +
  geom_jitter(alpha = 0.2) +
  facet_wrap(~ ages) +
  coord_flip() +  # flips the x and y axes
  scale_fill_manual(values = c("#C6E0FF", "#136F63", "#E0CA3C", "#F34213", "#3E2F5B")) +
  labs(title = "Malaria prevalence by location and age group",
       subtitle = "Data from 2018 - 2020",
       x = "Location",
       y = "Prevalence",
       fill = "Age group") +
theme_classic()

#ggsave("malaria-prevalence-age-boxplot.png", width = 10, height = 6, dpi = 300)
```


```{r}

```
































